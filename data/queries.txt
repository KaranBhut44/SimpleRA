LOAD EMPLOYEE
LOAD WORKS_ON
LOAD PROJECT

A <- SELECT Salary >= 30000 FROM EMPLOYEE
Q1 <- PROJECT Ssn, Salary FROM A

B <- CROSS EMPLOYEE EMPLOYEE
B1 <- SELECT EMPLOYEE1_Super_ssn == EMPLOYEE2_Ssn FROM B
B2 <- SELECT EMPLOYEE1_Bdate == EMPLOYEE2_Bdate FROM B1
Q2 <- PROJECT EMPLOYEE1_Ssn, EMPLOYEE2_Ssn, EMPLOYEE1_Bdate FROM B2
RENAME EMPLOYEE1_Ssn TO Ssn FROM Q2
RENAME EMPLOYEE2_Ssn TO Super_ssn FROM Q2
RENAME EMPLOYEE1_Bdate TO Bdate FROM Q2

C <- CROSS WORKS_ON EMPLOYEE
C1 <- SELECT Essn == Ssn FROM C
C2 <- SELECT Sex == 1 FROM C1
C3 <- PROJECT Pno FROM C2
C4 <- SELECT Sex == 0 FROM C1
C5 <- PROJECT Pno FROM C4
C6 <- CROSS C3 C5
C7 <- SELECT C3_Pno == C5_Pno FROM C6
Q3 <- PROJECT C3_Pno FROM C7
RENAME C3_Pno TO Pno FROM Q3

D1 <- CROSS EMPLOYEE WORKS_ON
D2 <- SELECT Ssn == Essn FROM D1
D3 <- CROSS D2 WORKS_ON
D4 <- SELECT Super_ssn == WORKS_ON_Essn FROM D3
D5 <- SELECT D2_Pno == WORKS_ON_Pno FROM D4
Q4 <- PROJECT Ssn,Super_ssn,D2_Pno FROM D5
RENAME D2_Pno TO Pno FROM Q4

E1 <- SELECT Dnum != 1 FROM PROJECT
E2 <- SELECT Dnum != 5 FROM E1
E3 <- CROSS PROJECT E2
E4 <- SELECT PROJECT_Dnum != E2_Dnum FROM E3
Q5 <- PROJECT PROJECT_Pnumber,PROJECT_Dnum FROM E4
RENAME PROJECT_Pnumber TO Pnumber FROM Q5
RENAME PROJECT_Dnum TO Dnum FROM Q5

EXPORT Q1
EXPORT Q2
EXPORT Q3
EXPORT Q4
EXPORT Q5

QUIT
